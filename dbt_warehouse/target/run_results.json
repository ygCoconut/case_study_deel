{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-01-15T23:59:26.098989Z", "invocation_id": "b6e743d1-0d72-4e49-9385-15f1dbb4c619", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-15T23:59:25.884756Z", "completed_at": "2025-01-15T23:59:25.889166Z"}, {"name": "execute", "started_at": "2025-01-15T23:59:25.889360Z", "completed_at": "2025-01-15T23:59:25.944016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05988907814025879, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_warehouse.stg_globepay__acceptance_report", "compiled": true, "compiled_code": "-- stg_globepay__acceptance_report.sql\n\nwith source as (\n    select * from \"prod_dwh\".\"raw\".\"src_globepay__acceptance_report\"\n),\n\nrenamed as (\n    select\n        -- ids\n        external_ref,\n        ref,\n\n        -- strings\n        source,\n        country,\n        currency,\n\n        -- numerics\n        amount,\n        (rates::jsonb ->> currency)::float AS rate,\n        amount/(rates::jsonb ->> currency)::float as amount_usd,\n\n\n        -- timestamps\n        to_timestamp(date_time , 'YYYY-MM-DD\"T\"HH24:MI:SS.MS\"Z\"') as date_time, \n\n        -- dates\n        to_timestamp(date_time, 'YYYY-MM-DD\"T\"HH24:MI:SS.MS\"Z\"')::date AS date,\n\n        -- booleans\n        status,\n        CASE\n            WHEN state LIKE 'ACCEPTED' THEN TRUE\n            ELSE FALSE\n        END AS is_accepted,\n        cvv_provided as has_cvv_provided\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"prod_dwh\".\"dwh_staging\".\"stg_globepay__acceptance_report\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-15T23:59:25.946822Z", "completed_at": "2025-01-15T23:59:25.948238Z"}, {"name": "execute", "started_at": "2025-01-15T23:59:25.948411Z", "completed_at": "2025-01-15T23:59:25.976571Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030372142791748047, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_warehouse.stg_globepay__chargeback_report", "compiled": true, "compiled_code": "-- stg_globepay__chargeback_report.sql\n\nwith source as (\n    select * from \"prod_dwh\".\"raw\".\"src_globepay__chargeback_report\"\n),\n\nrenamed as (\n    select\n        -- ids\n        external_ref,\n\n        -- strings\n        source,\n\n        -- booleans\n        chargeback as is_chargeback,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"prod_dwh\".\"dwh_staging\".\"stg_globepay__chargeback_report\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-15T23:59:25.978419Z", "completed_at": "2025-01-15T23:59:25.979954Z"}, {"name": "execute", "started_at": "2025-01-15T23:59:25.980118Z", "completed_at": "2025-01-15T23:59:26.027455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04967093467712402, "adapter_response": {"_message": "SELECT 181", "code": "SELECT", "rows_affected": 181}, "message": "SELECT 181", "failures": null, "unique_id": "model.dbt_warehouse.acceptance_rate_by_day", "compiled": true, "compiled_code": "-- acceptance_rate_by_day.sql\n\nwith\n\nacceptance_report as  (\n    select * from \"prod_dwh\".\"dwh_staging\".\"stg_globepay__acceptance_report\"\n),\n\nacceptance_rate_by_day as (\n    select \n        date,\n        COUNT(*) AS total_transactions,\n        COUNT(CASE WHEN is_accepted = TRUE THEN 1 END) AS accepted_transactions,\n        COUNT(CASE WHEN is_accepted = TRUE THEN 1 END) * 1.0 / COUNT(*) AS acceptance_rate\n    from \n        acceptance_report\n    group by \n        date\n    order by date desc\n)\n\nselect * from acceptance_rate_by_day", "relation_name": "\"prod_dwh\".\"dwh_marts.payments\".\"acceptance_rate_by_day\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-15T23:59:26.029456Z", "completed_at": "2025-01-15T23:59:26.031169Z"}, {"name": "execute", "started_at": "2025-01-15T23:59:26.031357Z", "completed_at": "2025-01-15T23:59:26.063856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03504300117492676, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.dbt_warehouse.amount_declined_over_25m_by_country", "compiled": true, "compiled_code": "-- amount_declined_over_25m_by_country.sql\n\nwith\n\nacceptance_report as  (\n    select * from \"prod_dwh\".\"dwh_staging\".\"stg_globepay__acceptance_report\"\n),\n\nchargeback_report as  (\n    select * from \"prod_dwh\".\"dwh_staging\".\"stg_globepay__chargeback_report\"\n),\n\njoined_reports as (\n    select \n        ar.*,\n        cr.is_chargeback\n    from acceptance_report ar\n    left join \n        chargeback_report cr\n        using (external_ref)\n),\n\naccepted_amount as (\n    select\n        round(sum(amount_usd)::numeric,2) as amount_usd,\n        country\n    from joined_reports\n    where \n        not is_accepted\n    group by country\n),\n\nthresholded_amount as (\n    select \n        *\n    from accepted_amount\n    where amount_usd > 25000000\n    order by amount_usd desc\n)\n\nselect * from thresholded_amount", "relation_name": "\"prod_dwh\".\"dwh_marts.payments\".\"amount_declined_over_25m_by_country\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-15T23:59:26.065840Z", "completed_at": "2025-01-15T23:59:26.067427Z"}, {"name": "execute", "started_at": "2025-01-15T23:59:26.067613Z", "completed_at": "2025-01-15T23:59:26.088966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023781776428222656, "adapter_response": {"_message": "SELECT 5207", "code": "SELECT", "rows_affected": 5207}, "message": "SELECT 5207", "failures": null, "unique_id": "model.dbt_warehouse.transactions_missing_chargeback", "compiled": true, "compiled_code": "-- transcations_missing_chargeback.sql\n\nwith\n\nchargeback_report as  (\n    select * from \"prod_dwh\".\"dwh_staging\".\"stg_globepay__chargeback_report\"\n),\n\nmissing_chargeback as (\n    select\n        *\n    from chargeback_report\n    where \n        not is_chargeback\n)\n\nselect * from missing_chargeback", "relation_name": "\"prod_dwh\".\"dwh_marts.payments\".\"transactions_missing_chargeback\"", "batch_results": null}], "elapsed_time": 0.3438997268676758, "args": {"favor_state": false, "printer_width": 80, "print": true, "indirect_selection": "eager", "state_modified_compare_vars": false, "include_saved_query": false, "log_level_file": "debug", "state_modified_compare_more_unrendered_values": false, "log_format": "default", "invocation_command": "dbt build", "require_yaml_configuration_for_mf_time_spines": false, "which": "build", "macro_debugging": false, "partial_parse_file_diff": true, "log_level": "info", "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "exclude": [], "require_resource_names_without_spaces": false, "select": [], "warn_error_options": {"include": [], "exclude": []}, "exclude_resource_types": [], "vars": {}, "send_anonymous_usage_stats": true, "project_dir": "/Users/nils/code/deelhometask/dbt_warehouse", "use_colors": true, "log_file_max_bytes": 10485760, "export_saved_queries": false, "profiles_dir": "/Users/nils/.dbt", "log_format_file": "debug", "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "quiet": false, "resource_types": [], "empty": false, "show": false, "introspect": true, "defer": false, "populate_cache": true, "use_colors_file": true, "source_freshness_run_project_hooks": false, "version_check": true, "log_path": "/Users/nils/code/deelhometask/dbt_warehouse/logs", "strict_mode": false, "cache_selected_only": false, "require_nested_cumulative_type_params": false}}